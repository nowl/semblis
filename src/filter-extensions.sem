; -*- mode: scheme -*-
(import "while-macro.sem")

(define (filter-files-by-extension file-list extension)
  ; Loops through the strings in file-list and if any of them don't
  ; contain the desired extension then they are rejected. The final
  ; list of all valid files is returned.
  (define result-list nil)
  (while (not (= file-list nil))
    (define file (first file-list))
    (if (>= (str:find file extension) 0)
        (set result-list (push file result-list)))
    (set file-list (rest file-list)))
  result-list)

(define files (list "file1.jpg" 
					"file2.jpg" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file4.bmp" 
					"lslp"
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"fucking.jpg" 
					"file4.ijp" 
					"file3.gif" 
					"file3.png" 
					"file4.bmp" 
					"file4.ijp" 
					"tits.jpg"
					"file4.png" 
					"file5.jpg"))

; test routine
;(display (filter-files-by-extension '("file1.jpg"
;                                      "file2.jpg"
;                                      "file3.gif"
;                                      "file4.png"
;                                      "file5.jpg")
;                                    ".jpg"))
;


(display (filter-files-by-extension files ".jpg"))


(newline) 
